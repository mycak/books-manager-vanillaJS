(()=>{let e=JSON.parse(localStorage.getItem("state"))||[],t=JSON.parse(localStorage.getItem("categories"))||[],o=JSON.parse(localStorage.getItem("modyfiedState"))||[];const a=document.querySelector("form"),n=document.querySelectorAll(".form__input"),r=document.querySelectorAll(".filter__input"),l=document.querySelector(".input__new__category"),i=document.querySelectorAll(".select__category"),c=document.querySelector(".table__data"),d=document.querySelector(".total"),s=document.querySelector(".total__category"),u=document.querySelector(".modal"),p=document.querySelectorAll(".modal__input"),m=(document.querySelector(".button__edit"),document.querySelector(".pdfData")),g=t=>{o=[...e],r.forEach((e=>{const t=e.dataset.kind,a=e.value;0!==a&&"0"!==a&&(o=o.filter((e=>e[t]===a)))})),b(o),_(o)},_=t=>{localStorage.setItem("state",JSON.stringify(e)),localStorage.setItem("modyfiedState",JSON.stringify(o)),c.innerHTML="",c.innerHTML=t.map((e=>`\n      <div\n        class="table__item draggable"\n        draggable="true"\n        ondragstart="onDragStart(event);"\n        ondrop="onDrop(event);"\n        data-id=${e.id}\n      >\n        <p>${e.title.charAt(0).toUpperCase()+e.title.slice(1)}</p>\n        <p>${e.author.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ")}</p>\n        <p>${e.category}</p>\n        <p>${"‚≠ê".repeat(e.priority)}</p>\n        <button class="button button__delete button__table" type="button" data-id=${e.id} onClick="deleteBook(this)"}>x</button>\n        <button class="button button__edit button__table" type="button" data-id=${e.id} onClick="openModal(this)"}>Edit</button>\n      </div>\n  `)).join(""),y(e)},y=e=>{d.innerHTML=`Total records ${e.length}`},b=t=>{t.length!==e.length?s.innerHTML=`Total records after filter ${t.length}`:s.innerHTML=""},h=()=>{[p[0],p[1]].forEach((e=>e.classList.remove("disabled"))),[n[0],n[1]].forEach((e=>e.classList.remove("disabled"))),l.classList.remove("disabled")};m?(c.innerHTML=o.map((e=>`\n    <div class="pdf__item">\n      <p>${e.title}</p>\n      <p>${e.author}</p>\n      <p>${e.category}</p>\n      <p>${e.priority}</p>\n    </div>\n`)).join(""),window.print(),setTimeout((()=>window.location.assign("/")),1e3)):(i.forEach((e=>{t.forEach((t=>{const o=document.createElement("option");o.value=t.toLowerCase(),o.innerHTML=t,e.appendChild(o)}))})),g(),a.addEventListener("submit",(t=>{const a=e.length?e[e.length-1].id+1:0;t.preventDefault();let r={};["title","author","category","priority"].forEach(((e,t)=>{r={...r,[e]:n[t].value}})),r={...r,id:a},""===n[0].value||""===n[1].value?[n[0],n[1]].forEach((e=>{""===e.value&&e.classList.add("disabled")})):(e.push(r),g(o),[n[0],n[1]].forEach((e=>{e.value=""})),n[2].value="criminal",n[3].value=1,h())})),r.forEach((e=>e.addEventListener("change",g))),u.addEventListener("click",(e=>{e.target.dataset.layer&&(u.classList.remove("open"),h())})))})();